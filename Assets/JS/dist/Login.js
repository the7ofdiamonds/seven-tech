import{c as p,a as j,s as x,b as f,d as w,f as y,e as E,r as g,j as e}from"./main.js";import{N as b}from"./NavigationLogin.js";import{u as S}from"./useDispatch.js";const v={loginLoading:!1,loginError:"",user_login:"",user_pass:"",user_email:"",first_name:"",last_name:"",user_id:""},i=p("login/signInEmailAndPassword",async a=>{try{const s=j(),n=a.email,l=a.password;await x(s,n,l),w(s,f);const o=y.currentUser;if(!o)throw new Error("User not found.",404);sessionStorage.setItem("email",n);const d={idToken:await o.getIdToken(),user_password:l},r=await fetch("/wp-json/seven-tech/v1/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(console.log(r),!r.ok){const c=(await r.json()).message;throw new Error(c)}return await r.json()}catch(s){throw console.error(s),s}});E({name:"login",initialState:v,extraReducers:a=>{a.addCase(i.fulfilled,(s,n)=>{s.loginLoading=!1,s.loginError="",s.loginMessage=n.payload}).addMatcher(isAnyOf(i.pending),s=>{s.loginLoading=!0,s.loginError=null}).addMatcher(isAnyOf(i.rejected),(s,n)=>{s.loginLoading=!1,s.loginError=n.error.message})}});function C(){const[a,s]=g.useState({email:"",password:""}),[n,l]=g.useState(""),[o,u]=g.useState("Enter your email and password to log in."),d=S(),r=t=>{const{name:c,value:h}=t.target;s({...a,[c]:h})},m=async t=>{t.preventDefault(),d(i(a))};return e.jsx(e.Fragment,{children:e.jsxs("main",{className:"login",children:[e.jsx(b,{}),e.jsx("div",{className:"login card",children:e.jsx("form",{onSubmit:m,children:e.jsxs("table",{children:[e.jsx("thead",{}),e.jsxs("tbody",{children:[e.jsx("tr",{children:e.jsx("td",{children:e.jsx("input",{type:"email",name:"email",placeholder:"Email",value:a.email,onChange:r,required:!0})})}),e.jsx("tr",{children:e.jsx("td",{children:e.jsx("input",{type:"password",name:"password",placeholder:"Password",value:a.password,onChange:r,required:!0})})})]}),e.jsx("tfoot",{children:e.jsx("td",{children:e.jsx("button",{type:"submit",children:e.jsx("h3",{children:"LOGIN"})})})})]})})}),o!==""&&e.jsx("div",{className:`status-bar card ${n}`,children:e.jsx("span",{children:o})})]})})}export{C as default};
//# sourceMappingURL=Login.js.map
